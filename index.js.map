{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '52986014-6c248434ffeaf5f82fd167a25';\n\nexport async function getImagesByQuery(query, page = 1, perPage = 15) {\n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page: perPage,\n    };\n\n    const { data } = await axios.get(BASE_URL, { params });\n    return data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryList = document.querySelector('.gallery');\nconst loader = document.querySelector('[data-loader]');\nconst loadMoreBtn = document.querySelector('[data-load-more]');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nexport function createGallery(imagesArray) {\n\n    const markup = imagesArray\n    .map(img => {\n        return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n                <img\n                    class=\"gallery-image\"\n                    src=\"${img.webformatURL}\"\n                    alt=\"${img.tags}\"\n                />\n            </a>\n\n            <ul class=\"stats\">\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Likes</span>\n                    <span class=\"stats-value\">${img.likes}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Views</span>\n                    <span class=\"stats-value\">${img.views}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Comments</span>\n                    <span class=\"stats-value\">${img.comments}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Downloads</span>\n                    <span class=\"stats-value\">${img.downloads}</span>\n                </li>\n            </ul>\n        </li>\n        `\n    })\n    .join('');\n\n    galleryList.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n\n}\n\nexport function clearGallery() {\n    galleryList.innerHTML = '';\n}\n\nexport function showLoader() {\n    loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader() {\n    loader.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n    loadMoreBtn.classList.remove('is-hidden');\n}\n\nexport function hideLoadMoreButton(){\n    loadMoreBtn.classList.add('is-hidden');\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton,} from './js/render-functions.js';\n\n\n\nconst form = document.querySelector('form');\nconst loadMoreBtn = document.querySelector('[data-load-more]');\n\nconst PER_PAGE = 15;\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', onSearchSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearchSubmit (event) {\n    event.preventDefault();\n\n    const searchText = event.currentTarget.elements['search-text'].value.trim();\n\n    if(!searchText) {\n        iziToast.error({\n            message: 'Please enter a search query.',\n            position: 'topRight',\n        });\n        return;\n    }\n\n    query = searchText;\n    page = 1;\n    clearGallery();\n    hideLoadMoreButton();\n    showLoader();\n\n    try {\n        const data = await getImagesByQuery(query, page, PER_PAGE);\n        totalHits = data.totalHits ?? 0;\n\n        if(!data.hits || data.hits.length === 0){\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n                icon: '',\n                class: 'toast-error', \n            });\n            return;\n        }\n\n        createGallery(data.hits);\n\n        const shown = page * PER_PAGE;\n\n        if (totalHits > shown) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n        } \n        \n    } catch (err) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.',\n            position: 'topRight',\n            icon: '',\n            class: 'toast-error',\n        });\n\n    } finally {\n        setTimeout(() => {\n            hideLoader();\n        }, 6000);\n        \n        form.reset();\n    }\n}\n\nasync function onLoadMore() {\n    page += 1;\n    hideLoadMoreButton();\n    showLoader();\n\n    try {\n        const data = await getImagesByQuery(query, page, PER_PAGE);\n        createGallery(data.hits);\n\n        smoothScrollByTwoCards();\n\n        const shown = page * PER_PAGE;\n        if (shown >= totalHits) {\n            hideLoadMoreButton();\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });  \n        } else {\n            showLoadMoreButton();\n        }\n\n    } catch (err) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.',\n            position: 'topRight',\n            icon: '',\n            class: 'toast-error',\n        });\n    } finally {\n        setTimeout(() => {\n            hideLoader();\n        }, 6000);\n    }\n}\n\nfunction smoothScrollByTwoCards() {\n    const firstCard = document.querySelector('.gallery .gallery-item');\n    if (!firstCard) return;\n    const { height } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n        top: height * 2,\n        behavior: 'smooth',\n    });\n}\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","perPage","params","data","axios","galleryList","loader","loadMoreBtn","lightbox","SimpleLightbox","createGallery","imagesArray","markup","img","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","PER_PAGE","totalHits","onSearchSubmit","onLoadMore","event","searchText","iziToast","shown","smoothScrollByTwoCards","firstCard","height"],"mappings":"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"}