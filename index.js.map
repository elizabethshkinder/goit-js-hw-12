{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '52986014-6c248434ffeaf5f82fd167a25';\n\nexport async function getImagesByQuery(query, page = 1, perPage = 15) {\n    const params = {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page,\n        per_page: perPage,\n    };\n\n    const { data } = await axios.get(BASE_URL, { params });\n    return data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst galleryList = document.querySelector('.gallery');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nexport function createGallery(imagesArray) {\n\n    const markup = imagesArray\n    .map(img => {\n        return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${img.largeImageURL}\">\n                <img\n                    class=\"gallery-image\"\n                    src=\"${img.webformatURL}\"\n                    alt=\"${img.tags}\"\n                />\n            </a>\n\n            <ul class=\"stats\">\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Likes</span>\n                    <span class=\"stats-value\">${img.likes}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Views</span>\n                    <span class=\"stats-value\">${img.views}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Comments</span>\n                    <span class=\"stats-value\">${img.comments}</span>\n                </li>\n                <li class=\"stats-item\">\n                    <span class=\"stats-label\">Downloads</span>\n                    <span class=\"stats-value\">${img.downloads}</span>\n                </li>\n            </ul>\n        </li>\n        `\n    })\n    .join('');\n\n    galleryList.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n\n}\n\nexport function clearGallery() {\n    galleryList.innerHTML = '';\n}\n\nexport function toggleLoader(position, show = true) {\n    const selector = position === 'top' ? '[data-loader-top]' : '[data-loader-bottom]';\n    const element = document.querySelector(selector);\n    element?.classList.toggle('is-hidden', !show);\n}\n\nexport function toggleLoadMoreButton(show = true) {\n    const btn = document.querySelector('[data-load-more]');\n    btn?.classList.toggle('is-hidden', !show);\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery } from \"./js/pixabay-api.js\";\nimport {createGallery, clearGallery, toggleLoader, toggleLoadMoreButton,} from './js/render-functions.js';\n\n\n\nconst form = document.querySelector('form');\nconst loadMoreBtn = document.querySelector('[data-load-more]');\n\nconst PER_PAGE = 15;\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nform.addEventListener('submit', onSearchSubmit);\nloadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearchSubmit (event) {\n    event.preventDefault();\n\n    const searchText = event.currentTarget.elements['search-text'].value.trim();\n\n    if(!searchText) {\n        iziToast.error({\n            message: 'Please enter a search query.',\n            position: 'topRight',\n        });\n        return;\n    }\n\n    query = searchText;\n    page = 1;\n    clearGallery();\n    toggleLoadMoreButton(false);\n    toggleLoader('top', true);\n\n    try {\n        const data = await getImagesByQuery(query, page, PER_PAGE);\n        totalHits = data.totalHits ?? 0;\n\n        if(!data.hits || data.hits.length === 0){\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n                icon: '',\n                class: 'toast-error', \n            });\n            return;\n        }\n\n        createGallery(data.hits);\n\n        const shown = page * PER_PAGE;\n        toggleLoadMoreButton(totalHits > shown);\n\n        if (totalHits <= shown) {\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });\n        }\n        \n    } catch (err) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.',\n            position: 'topRight',\n            icon: '',\n            class: 'toast-error',\n        });\n\n    } finally {\n        toggleLoader('top', false);\n        form.reset();\n    }\n}\n\nasync function onLoadMore() {\n    page += 1;\n    toggleLoadMoreButton(false);\n    toggleLoader('bottom', true);\n\n    try {\n        const data = await getImagesByQuery(query, page, PER_PAGE);\n        createGallery(data.hits);\n\n        smoothScrollByTwoCards();\n\n        const shown = page * PER_PAGE;\n        if (shown >= totalHits) {\n            toggleLoadMoreButton(false);\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n            });  \n        } else {\n            toggleLoadMoreButton(true);\n        }\n\n    } catch (err) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.',\n            position: 'topRight',\n            icon: '',\n            class: 'toast-error',\n        });\n    } finally {\n        toggleLoader('bottom', false);\n    }\n}\n\nfunction smoothScrollByTwoCards() {\n    const firstCard = document.querySelector('.gallery .gallery-item');\n    if (!firstCard) return;\n    const { height } = firstCard.getBoundingClientRect();\n    window.scrollBy({\n        top: height * 2,\n        behavior: 'smooth',\n    });\n}\n"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","perPage","params","data","axios","galleryList","lightbox","SimpleLightbox","createGallery","imagesArray","markup","img","clearGallery","toggleLoader","position","show","selector","element","toggleLoadMoreButton","btn","form","loadMoreBtn","PER_PAGE","totalHits","onSearchSubmit","onLoadMore","event","searchText","iziToast","shown","smoothScrollByTwoCards","firstCard","height"],"mappings":"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"}